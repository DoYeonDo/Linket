<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spacebetween.linket.mapper.TicketMapper">

    <resultMap type="TicketJoinDto" id="ticketSelectRM">
        <result property="ticketId" column="ticket_id"/>
        <result property="eventId" column="ticket_event_id"/>
        <result property="companyId" column="ticket_company_id"/>
        <result property="email" column="ticket_email"/>
        <result property="serialNum" column="serial_num"/>
        <result property="ticketReg" column="ticket_reg"/>
        <result property="ticketStatus" column="ticket_status"/>
        <result property="regDate" column="reg_date"/>
        <result property="lastUpdatedDate" column="last_updated_date"/>
    </resultMap>


    <!-- 티켓 등록 -->
    <update id="registerTicket" parameterType="TicketJoinDto">
        UPDATE ticket
        SET
            ticket_email=#{email}
        WHERE ticket_id=#{ticketId}
    </update>


    <!-- 티켓 전체 조회 -->
    <select id="getAllTickets" parameterType="string" resultMap="ticketSelectRM">
        SELECT *
        FROM ticket
        WHERE ticket_email=#{email} AND ticket_reg='Y' AND ticket_status='Y'
    </select>

    <!-- 티켓 단일 조회 -->
    <select id="getTicket" parameterType="long" resultMap="ticketSelectRM">
        SELECT *
        FROM ticket
        WHERE ticket_id=#{ticketId} AND ticket_reg='Y' AND ticket_status='Y'
    </select>

    <!-- 등록 티켓 삭제 -->
    <update id="deleteTicket" parameterType="TicketJoinDto">
        UPDATE ticket
        SET
            ticket_status=#{ticketStatus}
        WHERE ticket_id=#{ticketId}
    </update>
</mapper>
